---
// layouts/Layout.astro - Critical CSS Inlined
import '../styles/main.scss';

export interface Props {
  title?: string;
  description?: string;
  image?: string;
  keywords?: string;
  type?: 'website' | 'article' | 'product';
  price?: string;
  currency?: string;
  availability?: 'InStock' | 'OutOfStock' | 'PreOrder';
  category?: string;
  publishedDate?: string;
  datePublished?: string;
  modifiedDate?: string;
  dateModified?: string;
  author?: string;
  noindex?: boolean;
  alternateLanguages?: Array<{lang: string, url: string}>;
}

const {
  title = "Success Odyssey Hub - Transform Your Life with Proven Strategies",
  description = "Discover mental models, stoicism, and success philosophy. Transform your life with proven strategies and timeless wisdom for personal development.",
  image = "/assets/images/banner.webp",
  keywords = "success, philosophy, stoicism, mental models, personal development, mindfulness, self improvement",
  type = 'website',
  price,
  currency = 'USD',
  availability = 'InStock',
  category,
  publishedDate,
  datePublished,
  modifiedDate,
  dateModified,
  author = "Success Odyssey Hub",
  noindex = false,
  alternateLanguages = []
} = Astro.props;

const finalPublishedDate = publishedDate || datePublished;
const finalModifiedDate = modifiedDate || dateModified;
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
if (!canonicalURL.pathname.endsWith('/')) {
  canonicalURL.pathname += '/';
}

const imageSrc = typeof image === 'object' && image !== null && 'src' in image ? image.src : image;
const imageURL = (typeof imageSrc === 'string' && (imageSrc.startsWith('http') || imageSrc.startsWith('//') || imageSrc.startsWith('/_astro') || imageSrc.startsWith('/_assets')))
  ? imageSrc
  : new URL(imageSrc || '/assets/images/banner.webp', Astro.site).toString();

const currentDate = new Date().toISOString();

const pathSegments = Astro.url.pathname.split('/').filter(segment => segment);
const breadcrumbList = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": Astro.site?.toString()
    },
    ...pathSegments.map((segment, index) => ({
      "@type": "ListItem",
      "position": index + 2,
      "name": segment.charAt(0).toUpperCase() + segment.slice(1).replace('-', ' '),
      "item": new URL(pathSegments.slice(0, index + 1).join('/'), Astro.site).toString()
    }))
  ]
};

const mainSchema = {
  "@context": "https://schema.org",
  "@type": type === 'product' ? 'Product' : (type === 'article' ? 'BlogPosting' : 'WebSite'),
  "name": title,
  "headline": title,
  "description": description,
  "url": canonicalURL.toString(),
  "image": {
    "@type": "ImageObject",
    "url": imageURL,
    "width": 1200,
    "height": 630
  },
  "author": {
    "@type": "Organization",
    "name": author,
    "url": Astro.site?.toString()
  },
  "publisher": {
    "@type": "Organization",
    "name": "Success Odyssey Hub",
    "url": Astro.site?.toString(),
    "logo": {
      "@type": "ImageObject",
      "url": new URL('/assets/logo.png', Astro.site).toString(),
      "width": 120,
      "height": 120
    }
  }
};

if (type === 'product' && price) {
  mainSchema.offers = {
    "@type": "Offer",
    "price": price,
    "priceCurrency": currency,
    "availability": `https://schema.org/${availability}`,
    "url": canonicalURL.toString()
  };
  if (category) mainSchema.category = category;
}

if (type === 'article') {
  if (finalPublishedDate) {
    mainSchema.datePublished = finalPublishedDate;
    mainSchema.dateModified = finalModifiedDate || finalPublishedDate;
  } else {
    mainSchema.datePublished = currentDate;
    mainSchema.dateModified = currentDate;
  }
  mainSchema.mainEntityOfPage = {
    "@type": "WebPage",
    "@id": canonicalURL.toString()
  };
  mainSchema.inLanguage = "en-US";
  mainSchema.articleSection = "Personal Development";
  if (keywords) mainSchema.keywords = keywords.split(', ');
  mainSchema.wordCount = description.split(' ').length * 50;
}

if (type === 'website' && Astro.url.pathname === '/') {
  mainSchema.potentialAction = {
    "@type": "SearchAction",
    "target": "https://successodysseyhub.com/blog?search={search_term_string}",
    "query-input": "required name=search_term_string"
  };
}
---

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="generator" content={Astro.generator} />

<!-- Critical CSS Inlined - Full stylesheet loaded by Astro automatically -->
<style>
:root{--primary-color:#2563eb;--text-color:#1a1a1a;--bg-color:#fff;--gray-100:#f3f4f6;--gray-200:#e5e7eb;--gray-300:#d1d5db;--gray-600:#4b5563;--gray-800:#1f2937}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;line-height:1.6;color:var(--text-color);background:var(--bg-color);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.skip-to-main{position:absolute;top:-40px;left:6px;background:var(--primary-color);color:#fff;padding:8px;border-radius:0 0 4px 4px;text-decoration:none;z-index:1000}.skip-to-main:focus{top:0}.header{position:sticky;top:0;background:rgba(255,255,255,.95);backdrop-filter:blur(10px);box-shadow:0 2px 10px rgba(0,0,0,.05);z-index:100;border-bottom:1px solid var(--gray-200)}.nav{padding:1rem 0}.nav-container{max-width:1200px;margin:0 auto;padding:0 1.5rem;display:flex;align-items:center;justify-content:space-between}.logo{display:flex;align-items:center;gap:.5rem;font-weight:700;font-size:1.25rem;color:var(--text-color);text-decoration:none;transition:color .3s}.logo:hover{color:var(--primary-color)}.nav-links{display:flex;list-style:none;gap:2rem;align-items:center}.nav-links a{color:var(--text-color);text-decoration:none;font-weight:500;transition:color .3s;position:relative}.nav-links a:hover{color:var(--primary-color)}.nav-links a::after{content:'';position:absolute;bottom:-4px;left:0;width:0;height:2px;background:var(--primary-color);transition:width .3s}.nav-links a:hover::after{width:100%}.main{min-height:60vh}.footer{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:3rem 0 1rem}.footer-container{max-width:1200px;margin:0 auto;padding:0 1.5rem}.footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:2rem;margin-bottom:2rem}.footer-section h3{font-size:1.5rem;margin-bottom:1rem}.footer-section h4{font-size:1.125rem;margin-bottom:1rem}.footer-section p{opacity:.9;line-height:1.8}.footer-section ul{list-style:none}.footer-section ul li{margin:.5rem 0}.footer-section a{color:#fff;text-decoration:none;opacity:.9;transition:opacity .3s}.footer-section a:hover{opacity:1;text-decoration:underline}.footer-bottom{text-align:center;padding-top:2rem;border-top:1px solid rgba(255,255,255,.2)}.footer-bottom p{opacity:.8}@media(max-width:768px){.nav-container{flex-wrap:wrap}.nav-links{width:100%;justify-content:center;margin-top:1rem;gap:1rem;font-size:.9rem}.footer-content{grid-template-columns:1fr;text-align:center}}
</style>

<!-- Enhanced SEO -->
<title>{title}</title>
<meta name="description" content={description} />
<meta name="keywords" content={keywords} />
<meta name="author" content={author} />
<meta name="language" content="en" />
<meta name="revisit-after" content="7 days" />

<!-- Robots & Indexing -->
{noindex && <meta name="robots" content="noindex, nofollow" />}
{!noindex && <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />}

<!-- Canonical -->
<link rel="canonical" href={canonicalURL.toString()} />

<!-- Alternate Languages -->
{alternateLanguages.map(({lang, url}) => (
<link rel="alternate" hreflang={lang} href={url} />
))}

<!-- Favicon -->
<link rel="icon" href="/favicon.svg" type="image/svg+xml" />
<link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />

<!-- DNS Prefetch & Preconnect -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link rel="dns-prefetch" href="//www.googletagmanager.com" />

<!-- Fonts - Optimized loading -->
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" media="print" onload="this.media='all'" />
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" /></noscript>

<!-- Enhanced Open Graph -->
<meta property="og:type" content={type} />
<meta property="og:site_name" content="Success Odyssey Hub" />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:url" content={canonicalURL.toString()} />
<meta property="og:image" content={imageURL} />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:alt" content={title} />
<meta property="og:locale" content="en_US" />

{type === 'product' && price && (
<>
<meta property="product:price:amount" content={price} />
<meta property="product:price:currency" content={currency} />
<meta property="product:availability" content={availability.toLowerCase()} />
</>
)}

{type === 'article' && finalPublishedDate && (
<>
<meta property="article:published_time" content={finalPublishedDate} />
<meta property="article:modified_time" content={finalModifiedDate || currentDate} />
<meta property="article:author" content={author} />
<meta property="article:section" content="Personal Development" />
{keywords && keywords.split(', ').slice(0, 3).map(keyword => (
  <meta property="article:tag" content={keyword.trim()} />
))}
</>
)}

<!-- Enhanced Twitter Card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@successodyssey" />
<meta name="twitter:creator" content="@successodyssey" />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={imageURL} />
<meta name="twitter:image:alt" content={title} />

<!-- Theme -->
<meta name="theme-color" content="#2563eb" />
<meta name="msapplication-TileColor" content="#2563eb" />
<meta name="color-scheme" content="light dark" />

<!-- Performance & Security -->
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="format-detection" content="telephone=no" />

<!-- Enhanced Structured Data -->
<script type="application/ld+json" set:html={JSON.stringify(mainSchema)} />
<script type="application/ld+json" set:html={JSON.stringify(breadcrumbList)} />
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Success Odyssey Hub",
  "url": Astro.site?.toString(),
  "logo": new URL('/assets/logo.png', Astro.site).toString(),
  "sameAs": [
    "https://twitter.com/successodyssey",
    "https://facebook.com/successodyssey",
    "https://linkedin.com/company/successodyssey"
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer service",
    "availableLanguage": "English"
  },
  "address": {
    "@type": "PostalAddress",
    "addressCountry": "US"
  }
})} />

<meta name='impact-site-verification' value='bb9478d3-9161-4f57-ac16-eb1684e8d317'>

<!-- Google Tag Manager - Deferred -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}

  // Load GTM after page load
  window.addEventListener('load', function() {
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T34WMXZC');
  });
</script>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T34WMXZC"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<a href="#main-content" class="skip-to-main">Skip to main content</a>

<header class="header">
<nav class="nav" itemscope itemtype="https://schema.org/SiteNavigationElement">
<div class="nav-container">
<a href="/" class="logo" itemprop="url">
<svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="currentColor"/>
</svg>
<span itemprop="name">Success Odyssey Hub</span>
</a>
<ul class="nav-links">
<li><a href="/" itemprop="url">Home</a></li>
<li><a href="/blog" itemprop="url">Blog</a></li>
<li><a href="/products" itemprop="url">Products</a></li>
<li><a href="/about" itemprop="url">About</a></li>
</ul>
</div>
</nav>
</header>

<main id="main-content" class="main">
<slot />
</main>

<footer class="footer" itemscope itemtype="https://schema.org/WPFooter">
<div class="footer-container">
<div class="footer-content">
<div class="footer-section">
<h3>Success Odyssey Hub</h3>
<p>Transform your life with proven strategies and timeless wisdom.</p>
<div class="social-links">
<a href="https://twitter.com/successodyssey" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Twitter">
<svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor">
<path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
</svg>
</a>
<a href="https://facebook.com/successodyssey" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Facebook">
<svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor">
<path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
</svg>
</a>
<a href="https://linkedin.com/company/successodyssey" target="_blank" rel="noopener noreferrer" aria-label="Follow us on LinkedIn">
<svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor">
<path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
</svg>
</a>
</div>
</div>
<div class="footer-section">
<h4>Quick Links</h4>
<ul>
<li><a href="/">Home</a></li>
<li><a href="/blog">Blog</a></li>
<li><a href="/products">Products</a></li>
<li><a href="/about">About</a></li>
<li><a href="/privacy">Privacy Policy</a></li>
<li><a href="/terms">Terms of Service</a></li>
</ul>
</div>
<div class="footer-section">
<h4>Topics</h4>
<ul>
<li><a href="/blog/mental-models">Mental Models</a></li>
<li><a href="/blog/stoicism">Stoicism</a></li>
<li><a href="/blog/success-philosophy">Success Philosophy</a></li>
</ul>
</div>
</div>
<div class="footer-bottom">
<p>&copy; 2025 Success Odyssey Hub. All rights reserved.</p>
</div>
</div>
</footer>
</body>
</html>

<style lang="scss">
.social-links {
  display: flex;
  gap: 1.5rem;
  margin-top: 1rem;

  a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 50%;
    color: #333;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);

    &:hover {
      background: white;
      color: #1a1a1a;
      transform: translateY(-3px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    svg {
      width: 22px;
      height: 22px;
    }
  }
}

@media (max-width: 768px) {
  .social-links {
    justify-content: center;
    gap: 1.2rem;

    a {
      width: 40px;
      height: 40px;

      svg {
        width: 20px;
        height: 20px;
      }
    }
  }
}
</style>